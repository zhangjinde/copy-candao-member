function getConsumptionTypeName(e){var a={};switch(/^\d+$/.test(e)&&(e+=""),e){case"0":a={name:"现金消费",type:!1};break;case"1":a={name:"现金消费积分",type:!0};break;case"2":a={name:"储值消费",type:!1};break;case"3":a={name:"储值消费积分",type:!0};break;case"4":a={name:"积分消费",type:!1};break;case"5":a={name:"现金充值",type:!0};break;case"6":a={name:"现金消费反结算",type:!0};break;case"7":a={name:"现金消费积分反结算",type:!1};break;case"8":a={name:"储值消费反结算",type:!0};break;case"9":a={name:"储值消费积分反结算",type:!1};break;case"10":a={name:"积分消费反结算",type:!0};break;case"11":a={name:"银行卡充值",type:!0};break;case"13":a={name:"微信扫码支付",type:!1};break;case"14":a={name:"微信扫码支付反结算",type:!0};break;case"15":a={name:"微信扫码支付积分",type:!0};break;case"16":a={name:"微信扫码支付积分反结算",type:!1};break;case"17":a={name:"储值赠送",type:!0};break;default:a={name:"未知",type:!0}}return a}function addItems(e,a,t){$.ajax({url:InterFaceUrl.findDealDetailByCardno,type:"POST",dataType:"json",data:{cardno:util.getCookie("Cardno"),current:curPage,pagesize:t},success:function(e){var t="",i=e.detailDatas;return e.detailTotalpage===e.detailCurrent&&(isLastPage=!0,$(".infinite-scroll-preloader").remove()),$.each(i,function(e,a){t+='<li class="item-content notPadding"><div class="item-inner"><div class="item-title"><span class="item-title-type">'+getConsumptionTypeName(a.deal_type).name+'</span><p class="item-title-time">'+new Date(parseInt(a.deal_time)).pattern("yyyy-MM-dd HH:mm:ss")+'</p></div> <div class="item-after item-after-value-'+(getConsumptionTypeName(a.deal_type).type?"in":"out")+'">'+(getConsumptionTypeName(a.deal_type).type?"+":"-")+Math.abs(a.amount)+"</div></div></li>"}),0===a&&0===i.length?($(".infinite-scroll").html('<div style="text-align: center;padding:5rem 0;">暂无数据</div>'),void $(".infinite-scroll-preloader").remove()):(1==e.detailTotalpage&&$(".infinite-scroll-preloader").remove(),$(".infinite-scroll .list-container").append(t),curPage++,maxItems=e.detailTotal,void console.info(e.detailTotal))},error:function(){console.info("err"),$(".infinite-scroll .list-container").append('<li><div class="item-inner">请求数据错误！</div></li>')}})}var loading=!1,curPage=1,itemsPerLoad=20,maxItems=100,isLastPage=!1;sessionStorage.isFirstVist="false",$(function(){$(document).on("pageInit","#page-record",function(e,a,t){var i=$(".list-container li").length;addItems(itemsPerLoad,i,12),$(t).on("infinite",function(){loading||(loading=!0,setTimeout(function(){return loading=!1,i>=maxItems?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(!isLastPage&&addItems(itemsPerLoad,i,12),i=$(".list-container li").length,void $.refreshScroller())},1e3))})}),$.init()});